# Malware Infections

### Delivery methods (OBJ 1.1 & 1.5)
Malware has to be delivered to your computer, cannot just appear

**Threat vector** - method used by an attacker to access a victims machine
How  an attacker gets to the machine
Unpatched software
Usb flash drive
Phishing

**Attack vector** - method used by an attacker to gain access to a victims machine in order to infect it with malware
Both the way you got to the machine and how they infect it


### Common delivery methods
Malware infections usually start within software, messaging and media (Disks like cd or flash drive)
**Watering hole** - malware is placed on a website that you know your potential victims will access
**Type Squatting** - <a href="http://DionTraining.com" rel="noopener" class="external-link" target="_blank" style="color:#e4afaff;">DionTraining.com</a> vs <a href="http://DionTrainings.com" rel="noopener" class="external-link" target="_blank" style="color:#e4afaff;">DionTrainings.com</a> 


### Botnets & Zombies (OBJ 1.2 & 1.4)
Change your computer to a zombie for a botnet
Botnet - a collection of compromised computers under the control of a master node
Command and control node (C2)
Used for DDOS Attack
Botnets can be utilized in other processor intensive functions and activities
Crypto mining
Breaking encryption


![[Screen Shot 2020-11-16 at 9.16.32 AM.png]]



### Active Interception & Privilege Escalation (OBJ 1.3 & 1.4)

**Active Interception** - Occurs when a computer is placed between the sender and receiver and is able to capture or modify the traffic between them

**Privilege Escalation** - Occurs when you are able to exploit a design flaw or bug in a system to gain access to resources that a normal user isn’t able to access

Exploiting bug in software, OS or Applications - gets close to kernel to act as administrator


### Backdoors and Logic Bombs (OBJ 1.2)
**Back Doors** are used to **bypass** normal security and authentication functions.

**Remote Access Trojan (RAT)** - placed by an attacker to maintain persistent access

**Easter egg** - Non-malicious code that when invoked, displays an insider joke, hidden message or secret feature

**Logic Bombs** - Malicious code that has been inserted inside a program and will execute only when certain conditions have been met

Logic Bombs and Easter eggs should not be used according to **secure coding standards**.

### Symptoms of Infection (OBJ 1.2)
Your computer might have been infected if it acts strangely

- &nbsp;
			- Computer might be slower than normal
			- Locks up , freezing, blue screen of death
			- Hard drives, files or applications are not accessible anymore
			- Strange nosies occur
			- Unusual error messages
			- Display looks strange
			- Jumbled printouts
			- New icons or missing icons
			- Double file extensions such as textile.txt.exe
			- Antivirus will not run
			- Files/folders corrupted or new files/folders have been created
			- System restore will not function

### Removing Malware (OBJ 4.2)
Make sure to have a good backup

- &nbsp;
	1. **Identify** symptoms of a malware infection
	1. **Quarantine** the infected systems
		1. Unplugged network connection
	1. **Disable** system restore (If using a windows machine)
		1. Delete any snapshots that may be infected
	1. **Remediate** the infected system
	2. **Schedule** Automatic update and scans
	3. **Enable system restore** and create a new restore point
	4. Provide end user **security awareness training**

If a boot sector virus is suspected, reboot the computer from an external device and scan it

Physically remove drive from infected computer and connect to known good computer to scan as secondary drive.

### Preventing Malware (OBJ 1.6 & 3.2)
Viruses
Use a good anti virus
Do services packs and updates for OS
Taking advantage to unpatched computers
Have a strong host based firewall
Use encrypted websites
Use anti spyware
Keep definitions up to date
Low level of trust for websites
Lots of pop up ads
Homepage is changed

Worms, Trojans and ransomeware are best detected with anti malware solutions

Rootkits
Installs itself between kernel and OS
Scanners can detect a file containing a rootlet before it is installed
Must scan from a different computer
Removal of a rootlet is difficult and the best plan is to reimagine the machine (Computer erase and restore to known good baseline

Spam - verify your email servers aren’t configured as open mail relays or smtp open relays
Remove email address from your website
Use whitelists and blacklists
Train and educate end users


- &nbsp;
		1. Always update anti Malware software automatically and scan your computer
		2. Update and patch the operating system and applications regularly
		3. Educate and train end users on safe internet surfing practices

### Malware exploitation (OBJ 1.2)
Exploit Technique - Describes the specific method by which malware code infects a target host
Most modern malware uses file-less techniques to avoid detection by signature-based security software
How does an APT use modern malware to operate?

- &nbsp;
			1. Dropper or downloader
				1. Light-weight script or shell code
				2. Trick user to click
				3. Code injection - exploit technique that runs malicious code with the identification number of a legitimate process
					1. Masquerading
					2. DLL Inection
					3. DLL side loading
					4. Process hollowing
			1. Maintain access
			2. Strengthen access
			3. Actions on objectives
				1. Copying or stealing files
			1. Concealment
				1. Start hiding themselves by deleting log files

Living off the land - exploiting techniques that use standard system tools and packages to perform instructions (using Powershell)

Detection of an adversary is more difficult when they are executing malware code within standard tools and processes